%%%%
%%%% Change style and appearance of the SSA-book manuscript here.
%%%%
%%%% Author: Florent Bouchez
%%%%

%% Change styles of chapters, sections and subsections

% At beginning of chapter, put author names on the far right
\def\changeAuthor{%
  \def\Author##1{\hfill \emph{\large ##1}}
  \def\andAuthor{\par\hfill}
  \def\chapternewline{\andAuthor}
}

\font\chapternumstyle=cmbx10 at 30pt

\titleformat{\chapter}[display]
  {\bfseries\Large}
  {\filleft\MakeUppercase{\chaptertitlename} \chapternumstyle\thechapter}
  {4ex}
  {\titlerule
   \changeAuthor
   \vspace{2ex}%
   \filright
  }
  [\vspace{2ex}%
   \titlerule]

\titleformat{\section}[hang]
  {\normalfont
   \titlerule*[.7em]{\bfseries.}%
   \vspace{6pt}%
   \sffamily\bfseries\Large}
  {\setbox0\hbox{\thesection}%
  \kern-\wd0\kern-.5em\box0}{.5em}{}

\titleformat{\subsection}[hang]
  {\itshape\bfseries\large}
  {\setbox0\hbox{\thesubsection}%
  \kern-\wd0\kern-.5em\box0}{.5em}{}

\titleformat{\subsubsection}[hang]
  {\itshape\bfseries\normalsize}
  {\setbox0\hbox{\thesubsubsection}%
  \kern-\wd0\kern-.5em\box0}{.5em}{}



%%% Change float (figure / tables) style

%% Add rules above and below figures
\floatsetup{
%  style=ruled,
%  precode=thickrule,
  midcode=rule,
%  postcode=thickrule
}


%% Change caption styles
% Make labels of figure and tables stick into the left margin
\DeclareCaptionFormat{marginlabel}{%
  \setbox0\hbox{#1#2}{\kern-\wd0\box0#3}%
}

\captionsetup{%
  font=small,%
  labelfont=bf,%
  format=marginlabel,%
  labelsep=quad,%
  justification=justified,%
  singlelinecheck=false%  do not center single line captions
}
\captionsetup[subfloat]{%
  format=plain,%
%  labelfont={bf,it},%
  singlelinecheck=true% center single line captions
}


%% Change the quote and quotation styles to use italics and quotation marks
\expandafter\def\expandafter\quote\expandafter{\quote\hskip-1.2em 
\raisebox{-1.5ex}[0pt][0pt]{\Large``}\kern.5ex\it}
\let\oldendquote=\endquote
\def\endquote{\raisebox{-1em}[0pt][0pt]{\Large''}\oldendquote}
%\expandafter\def\expandafter\endquote\expandafter{\expandafter{\Large''}\endquote}

\expandafter\def\expandafter\quotation\expandafter{\quotation\it}


%% "Figure" for title page: display introduction in "Ï†-shape"
\def\philongtailshape{{8.8}{0}b{8.8}
\\{0}t{7.2}{0.8}    t{12.4}{2.4}
\\{0.8}t{5.6}{2.8}  t{11.2}{4.8}
\\{1.6}t{4.4}{3.2}  t{10.4}{3.2}st{13.6}{3.2}
\\{2.4}t{3.6}{2.8}  t{10.0}{2.4} t{13.2}{3.6}
\\{3.6}t{2.8}{3.2}  t{9.6}{2.0}  t{14.0}{3.2}
\\{4.8}t{2.4}{2.8}  t{8.8}{2.8}  t{14.4}{3.2}
\\{6.0}t{2.0}{2.4}  t{8.8}{2.4}  t{14.8}{2.8}
\\{7.2}t{1.6}{2.4}  t{8.4}{2.8}  t{15.2}{2.4}
\\{8.4}t{0.8}{3.2}  t{8.0}{2.8}  t{15.2}{2.4}
\\{9.6}t{0.8}{2.8}  t{8.0}{2.8}  t{15.2}{2.4}
\\{10.8}t{0.8}{2.8} t{8.0}{2.8}  t{14.8}{2.8}
\\{12.0}t{0.8}{3.2} t{7.6}{3.2}  t{14.8}{2.4}
\\{13.2}t{0.8}{3.2} t{7.6}{2.8}  t{14.4}{2.4}
\\{14.4}t{1.2}{3.2} t{7.6}{2.8}  t{14.0}{2.4}
\\{15.6}t{1.6}{3.6} t{7.2}{3.2}  t{13.2}{2.8}
\\{16.8}t{2.0}{4.0} t{7.2}{3.2}  t{11.6}{3.6}
\\{18.0}t{2.8}{3.86666666667}jt{6.66666666667}{3.86666666667}jt{10.5333333333}{3.86666666667}
\\{18.4}t{3.6}{9.2}
\\{18.8}t{5.6}{5.2}
\\{19.2}t{6.8}{3.2}
\\{19.6}t{6.8}{3.2}
\\{20.0}t{6.8}{3.1}
\\{20.4}t{6.8}{3.1}
\\{20.8}t{6.6}{3.2}
\\{21.2}t{6.6}{3.3}
\\{21.6}t{6.6}{3.1}
\\{22.0}t{6.5}{3.2}
\\{22.4}t{6.5}{3.0}
\\{22.8}t{6.4}{3.0}
\\{23.2}t{6.6}{3.1}
\\{23.6}t{6.4}{3.0}
\\{24.0}t{6.4}{2.9}
\\{24.4}t{6.2}{2.8}
\\{24.8}t{6.4}{2.9}
\\{25.2}t{6.4}{2.8}
\\{25.6}t{6.4}{2.7}
\\{26.0}t{6.2}{2.8}
\\{26.4}t{6.4}{2.7}
\\{26.8}t{6.4}{2.7}
\\{27.2}t{6.6}{2.6}
\\{27.6}t{6.4}{2.6}
\\{28.0}t{6.2}{2.5}
\\{28.4}t{6.2}{2.4}
\\{28.8}e{8.8}}



%% Code styles
\colorlet{commentcolor}{blue!50!black}
% \definecolor{commentcolor}{HTML}{8da0cb}
% \colorlet{commentcolor}{cbBlue!50!black}

\SetKwComment{Comment}{{$\rhd$ }}{}
\lstset{
  basicstyle=\footnotesize,
  breaklines=true,
  commentstyle=\itshape,%\color{commentcolor},
  columns=fullflexible,
  backgroundcolor=\color{black!15},
  texcl,
  mathescape  % allows usage of $<math stuff>$ inside listings
}
\newcommand\mycommentstyle[1]{{\itshape\color{commentcolor}#1}}
\DontPrintSemicolon
\SetCommentSty{mycommentstyle}


%% Tikz styles

\ssausepackage{tikzstyle} % all tikz environments defined there


% Progress bars
\newprogressbar[name=Progress]{part1}
\newprogressbar[name=Progress]{part2}
\newprogressbar[name=Progress]{part3}
\newprogressbar[name=Progress]{part4}

\newprogressbar[name=Draft,cols=red,cole=green]{draft}
\newprogressbar[name=Draft review, cols=red,cole=green]{draftreview}
\newprogressbar[name=Writing, cols=red,cole=green]{writing}
\newprogressbar[name=Fab's review, cols=red,cole=green]{fabreview}
\newprogressbar[name=Peer review, cols=red,cole=green]{peerreview}
\newprogressbar[name=Rewriting, cols=red,cole=green]{rewriting}
\newprogressbar[name=Polishing, cols=red,cole=green]{polish}

\newcommand\inputprogress{
  \IfFileExists{progress}{%
    \input{progress}%
  }{%
    \ifx\currentssadir\undefined
      {\color{orange} No progress bar available for this chapter (searched in . 
      and command `currentssadir' is not defined).\\\bigskip}
    \else
    \IfFileExists{\ssaroot{\currentssadir/progress}}{
    \input{\ssaroot{\currentssadir/progress}}%
    }{%
      {
      \catcode`_=12
      \color{orange} No progress bar available for this chapter (directories 
      searched: . and \ssaroot{\currentssadir}).\\\bigskip}
    }
    \fi
  }
}

% Environment to typeset C code (uses listings)
\lstnewenvironment{ccode}{\lstset{language=C}}{}

\newenvironment{algorithmic}{
  \centerline{\color{red} Warning: package ``algorithmic'' is no longer used. Please use algorithm2e instead.}
  \message{LaTeX Warning: Package ``algorithmic'' is no longer used. Please use algorithm2e instead.}
  \verbatim
}{
  \endverbatim
}

% Algorithm2e
\SetArgSty{textnormal}
%\SetCommentSty{textit}
\SetKw{Let}{let\ }
\SetKw{KwLet}{\bf let}
\SetKwProg{Fn}{Function}{}{}
\SetKwFunction{KwUpdateloc}{update\_worklist}
\SetAlFnt{\small} % set default font for algorithms

