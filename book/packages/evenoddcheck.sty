%%
%% This is file `evenoddcheck.sty',
%% 
%% This package is in the public domain. It comes with no guarantees
%% and no reserved rights. You can use or modify this package at your
%% own risk.
%%
%%   The goal of this package is to provide a mechanism by which you
%%  one can check that two sequences of text or figures appear either
%%  on the same page or on two pages appearing face-to-face in a two-
%%  side setting, i.e., on successive even and odd pages.
%%  A warning is issued if this is not the case.
%%
%%   This package provides two commands:
%%     - \evenoddcheck{foo} marks the current page as the page where
%%       'foo' appear.
%%     - \evenoddendcheck{foo} checks that the current page is either
%%       the same as where 'foo' appeared, or is the next page and is 
%%       odd.
%%
%% Author: Florent Bouchez
%% 
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{evenoddcheck}
\RequirePackage{xcolor}
\RequirePackage{xkeyval}

\makeatletter

\def\evenoddcheck#1{
  \expandafter\global\expandafter\xdef\csname Checkevenodd@#1@start\endcsname{\thepage}
}
\def\evenoddendcheck#1{
  \ifodd\csname Checkevenodd@#1@start\endcsname
    \ifnum\csname Checkevenodd@#1@start\endcsname=\thepage\else
      \message{^^JLaTeX Warning: Even-Odd check failed!}
       \message{LaTeX Warning: #1 started on odd page \csname 
       Checkevenodd@#1@start\endcsname, end is on \thepage.}
    \fi
  \else
    {\count2=\thepage
     \advance\count2 by - \csname Checkevenodd@#1@start\endcsname
     Count 2 is ``\the\count2''.
     \ifnum\count2 > 1
       \message{^^JLaTeX Warning: Even-Odd check failed!}
       \message{LaTeX Warning: #1 started on even page \csname 
       Checkevenodd@#1@start\endcsname, end is on \thepage.}
     \fi
    }
  \fi
}
\makeatother
